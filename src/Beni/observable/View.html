<!DOCTYPE html>
<html>
<head>
    <title>View</title>
    <script src="../../Pascal/playground.js"></script>
    <script src="observable.js"></script>
    <link rel="stylesheet" href="../style.css">

</head>
<body>


<input id="name" type="text">
<div id="label"></div>
<div id="size"></div>

<script>
    const getElement = id => document.getElementById(id);
    const getElements = (...id) => id.map(e => getElement(e))

    // const nameInput = getElement("name");
    // const label = getElement("label");
    // const sizes = getElement("size");
    const [nameInput, label, sizes] = getElements("name", "label", "size")

    // "let" wenn soll zus채tzliche Listener hinzugef체gt werden,
    // ansonsten, wenn immutable mit "const" vor ver채nderung sch체tzen
    let inputObservable = InitObservable
    (addListener)(val => label.innerText = val)
    (addListener)(val => sizes.innerText = val.length)

    nameInput.oninput = _ => inputObservable(setValue)(nameInput.value);

</script>
<hr>

<style>

    .rgbView {
        font-family: Consolas, 'courier new'
    }

    .padding-large {
        padding: 20px;
        background-color: #f1f1f1;
        overflow: hidden;
    }


    #resultColor {
        height: 200px;
    }

    .slider {
        -webkit-appearance: none;
        height: 15px;
        border-radius: 5px;
        background: #d3d3d3;
        outline: none;
        opacity: 0.7;
        -webkit-transition: .2s;
        transition: opacity .2s;
    }

</style>

<div class="overflow-hidden">
    <div class="padding-large w-full">
        <h2>RGB Calculator</h2>
        <br>
        <div class="row">
            <div class="col w-50" style="background-color: rgb(128, 172, 0);"  id="resultColor"></div>
            <div class="col w-10">&nbsp;</div>
            <div class="col w-40">
                <div class="">
                    <input id="rgbValue" type="text" class="pt-3 pb-3">
                    <br>
                    <br>

                    <div id="hex" class="pt-3 pb-3">#80ac00</div>
                    <br>
                    <div id="hsl" class="pt-3 pb-3">hsl(75, 100%, 34%)</div>
                </div>
            </div>
        </div>
        <br>
        <div class="row w-full">
            <div class="col ">R:</div>
            <input type="number" id="inputR" value="0" class="col w-10 mx-5">
            <input type="range" min="0" max="255" value="0" class="slider col w-80" id="rangeR">
        </div>
        <br>
        <div class="row w-full">
            <div class="col ">G:</div>
            <input type="number" id="inputG" value="0" class="col w-10 mx-5">
            <input type="range" min="0" max="255" value="0" class="slider col w-80" id="rangeG">
        </div>
        <br>
        <div class="row w-full">
            <div class="col ">B:</div>
            <input type="number" id="inputB" value="0" class="col w-10 mx-5">
            <input type="range" min="0" max="255" value="0" class="slider col w-80" id="rangeB">
        </div>
    </div>
</div>
<script>
    const [resultColor, rgbValue, hex, hsl] = getElements("resultColor", "rgbValue", "hex", "hsl")
    const [inputR, inputG, inputB] = getElements("inputR", "inputG", "inputB")
    const [rangeR, rangeG, rangeB] = getElements("rangeR", "rangeG", "rangeB")

    const inputListener  = (obs, inputer) => inputer.addEventListener('input', _ => obs(setValue)(inputer.value))
    const inputListeners = (obs, ...inputers) => inputers.map(input => inputListener(obs, input))

    let valueR, valueG, valueB

    const obsR = InitObservable
            (addListener)(r => valueR = r)
            (addListener)(r => inputR.value = r)
            (addListener)(r => rangeR.value = r)
            (addListener)(r => resultColor.style.backgroundColor  = 'rgb(' + r + ',' + valueG + ',' + inputB.value + ')' )
            (addListener)(r => rgbValue.value = 'rgb(' + r + ',' + inputG.value + ',' + inputB.value + ')' )


    inputListeners(obsR, inputR, rangeR)

    const obsG = InitObservable
            (addListener)(g => valueG = g)
            (addListener)(g => inputG.value = g)
            (addListener)(g => rangeG.value = g)
            (addListener)(r => resultColor.style.backgroundColor  = 'rgb(' + r + ',' + valueG + ',' + inputB.value + ')' )

    inputListeners(obsG, inputG, rangeG)

    const obsB = InitObservable
            (addListener)(b => inputB.value = b)
            (addListener)(b => rangeB.value = b)

    inputListeners(obsB, inputB, rangeB)



    // const setRGBcolor = object => r => g => b => {
    //     object.style.backgroundColor  = 'rgb(' + r + ',' + g + ',' + b + ')'; //"rgb(" + r + "," + g + "," + b + ");" //`rgb(${r},${g}.${b})`
    // }



</script>
</body>
</html>
